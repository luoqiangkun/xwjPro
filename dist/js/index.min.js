var _createClass=function(){function i(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,e,a){return e&&i(t.prototype,e),a&&i(t,a),t}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Directseller=function(){function t(){_classCallCheck(this,t),this.state=-1,this.router={},this.data={},this._data(),this._router(),this._check()}return _createClass(t,[{key:"_data",value:function(){var e=this;$.request({type:"post",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=info&typ=json",dataType:"json",async:!1,success:function(t){200===t.status&&(e.state=t.data.directseller_enable,e.data=t.data)}})}},{key:"_check",value:function(){-1<this.state?0===this.state||2===this.state?"result"!==this.router.path&&(window.location.href="/dist/views/result.html"):"result"!==this.router.path&&"apply"!==this.router.path&&"distributor"!==this.router.path&&"sharer"!==this.router.path||(window.location.href="/dist/views/home.html"):"apply"!==this.router.path&&"distributor"!==this.router.path&&"sharer"!==this.router.path&&(window.location.href="/dist/views/distributor.html")}},{key:"_router",value:function(){var t=window.location,e="/dist/views/",a=void 0;if(t.pathname)switch(t.pathname){case e+"apply.html":a="apply";break;case e+"distributor.html":a="distributor";break;case e+"home.html":a="home";break;case e+"income.html":a="income";break;case e+"order.html":a="order";break;case e+"result.html":a="result";break;case e+"store.html":a="store";break;case e+"sharer.html":a="sharer";break;case e+"setting.html":a="setting";break;default:a="index"}var i={path:a,href:t.search,search:t.search};this.router=i}}]),t}(),directseller=new Directseller;!function(){if(document.getElementById("apply"))new Vue({el:"#apply",data:{},methods:{},created:function(){}})}(),function(){if(document.getElementById("distributor"))new Vue({el:"#distributor",data:{storeId:0,storeName:"",areaName:"",location:{},addressName:"",addressIndex:0,addressLists:[],storeLists:{}},methods:{initBMapView:function(){var s=this,t=new BMap.Geolocation;new BMap.Geocoder;t.getCurrentPosition(function(t){if(this.getStatus()==BMAP_STATUS_SUCCESS){var e=new BMap.Map("baidu_map"),a=new BMap.Point(t.point.lng,t.point.lat);e.centerAndZoom(a,15);var i=new BMap.Marker(t.point);e.addOverlay(i),e.panTo(t.point),s.location={lat:t.point.lat,lng:t.point.lng},s.getLocateLists()}},{enableHighAccuracy:!0})},getLocateLists:function(){var e=this,t={location:this.location.lat+","+this.location.lng,area_name:this.areaName};$.request({type:"post",url:ApiUrl+"/index.php?ctl=Index&met=nearbyArea&typ=json",data:t,dataType:"json",success:function(t){e.addressLists=t.data.items}})},getStoreLists:function(){var e=this;$.request({type:"post",url:ApiUrl+"/index.php?ctl=Store&met=lists&typ=json",data:{show_product:1},dataType:"json",success:function(t){e.storeLists=t.data}})},storeHandle:function(){this.getStoreLists()},clickHandle:function(t){this.storeId=t.store_id,this.storeName=t.store_name,this.$refs.storeHeader.click()},selectHandle:function(t,e){this.areaName=t.name,this.location=t.location,this.addressName=t.address,this.addressIndex=e,this.$refs.addressHeader.click()},submitHandle:function(){var t={store_id:this.store_id,area:this.areaName,latitude:this.location.lat,longitude:this.location.lng,address:this.addressName,directseller_type:1};$.request({type:"post",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=apply&typ=json",data:t,dataType:"json",success:function(t){200===t.status?window.location.href="/dist/views/result.html":$.sDialog({skin:"red",content:t.msg,okBtn:!1,cancelBtn:!1})}})},backHandle:function(){history.go(-1)}},mounted:function(){$.animationLeft({valve:"#new-address-valve",wrapper:"#new-address-wrapper",scroll:""}),$.animationLeft({valve:"#new-store-valve",wrapper:"#new-store-wrapper",scroll:""})},created:function(){this.initBMapView()}})}(),function(){if(document.getElementById("sharer"))new Vue({el:"#sharer",data:{storeId:0,storeName:""},methods:{submitHandle:function(){var t={store_id:this.storeId,directseller_type:2};$.request({type:"post",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=apply&typ=json",data:t,dataType:"json",success:function(t){200===t.status?window.location.href="/dist/views/result.html":$.sDialog({skin:"red",content:t.msg,okBtn:!1,cancelBtn:!1})}})},backHandle:function(){history.go(-1)}}})}(),function(){if(document.getElementById("result"))new Vue({el:"#result",data:{id:"",state:1,type:""},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=info&typ=json",data:{apply_id:this.id},dataType:"json",success:function(t){e.state=t.data.apply_state,e.type=t.data.apply_type}})},backHandle:function(){history.go(-1)}},created:function(){this.state=directseller.state,this.type=directseller.data.directseller_type}})}(),function(){if(document.getElementById("home"))new Vue({el:"#home",data:{},methods:{storeRouterHandle:function(){window.location.href="/dist/views/store.html"},incomeRouterHandle:function(){window.location.href="/dist/views/income.html"},taskRouterHandle:function(){window.location.href="/dist/views/task.html"},backHandle:function(){history.go(-1)}},created:function(){this.type=directseller.data.directseller_type}})}(),function(){if(document.getElementById("income"))new Vue({el:"#income",data:{data:{}},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=income&typ=json",data:{apply_id:this.id},dataType:"json",success:function(t){e.data=t.data}})},commissionRouterHandle:function(){window.location.href="/dist/views/commission.html"},orderRouterHandle:function(){window.location.href="/dist/views/order.html"},backHandle:function(){history.go(-1)}},created:function(){this.getData()}})}(),function(){if(document.getElementById("store"))new Vue({el:"#store",data:{show:!1,shop:{}},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Shop&met=info&typ=json",dataType:"json",success:function(t){e.shop=t.data}})},shareHandle:function(){this.show=!0},qrcodeHandle:function(){this.show=!0},storeRouterHandle:function(){window.location.href="/dist/views/setting.html"},settingRouterHandle:function(){window.location.href="/dist/views/setting.html"},productRouterHandle:function(){window.location.href="/dist/views/product.html"},shopRouterHandle:function(t){window.location.href="/dist/views/shop.html?shop_id="+t},backHandle:function(){history.go(-1)}},created:function(){this.getData()}})}(),function(){if(document.getElementById("commission"))new Vue({el:"#commission",data:{orderData:{page:1,records:0,total:0,items:[]}},methods:{getOrderData:function(t){var e=this;if(this.orderData.total!=this.orderData.page){var a={page:t||1,rows:10};$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_User&met=listsOrder&typ=json",data:a,dataType:"json",success:function(t){e.orderData.page=t.data.page,e.orderData.records=t.data.records,e.orderData.total=t.data.total,e.orderData.items.push.apply(e.orderData.items,t.data.items)}})}},backHandle:function(){history.go(-1)}},created:function(){var t=this;this.getOrderData(),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-1&&t.getOrderData(t.orderData.page+1)})}})}(),function(){if(document.getElementById("task"))new Vue({el:"#task",data:{task:"0",order_amount:"0"},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=income&typ=json",data:{apply_id:this.id},dataType:"json",success:function(t){e.order_amount=t.data.order_amount}})},backHandle:function(){history.go(-1)}},created:function(){this.task=directseller.data.directseller_task,this.getData()}})}(),function(){if(document.getElementById("order"))new Vue({el:"#order",data:{activeIndex:-1,dropdownMenu:[{text:"订单状态",index:0},{text:"订单结算",index:0}],income:"0.00",orderData:{page:1,records:0,total:0,items:[]},orderTitle:"",orderStatus:""},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Directseller&met=income&typ=json",data:{apply_id:this.id},dataType:"json",success:function(t){e.income=t.data.commission_amount}})},getOrderData:function(t){var e=this;if(this.orderData.total!=this.orderData.page){var a={page:t||1,rows:5,order_title:this.orderTitle,order_status:this.orderStatus};$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_User&met=listsOrder&typ=json",data:a,dataType:"json",success:function(t){e.orderData.page=t.data.page,e.orderData.records=t.data.records,e.orderData.total=t.data.total,e.orderData.items.push.apply(e.orderData.items,t.data.items)}})}},clickHandle:function(t,e,a){this.dropdownMenu[t].index!==e&&this.searchHandle(),this.activeIndex=-1,this.dropdownMenu[t]={text:a,index:e}},searchHandle:function(){this.orderData={page:1,records:0,total:0,items:[]},this.getOrderData()},backHandle:function(){history.go(-1)}},created:function(){var t=this;this.getData(),this.getOrderData(),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-1&&t.getOrderData(t.orderData.page+1)})}})}(),function(){if(document.getElementById("setting"))new Vue({el:"#setting",data:{form:{shop_id:0,shop_name:"",shop_logo:"",shop_banner:"",shop_description:""}},methods:{getData:function(){var n=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Shop&met=info&typ=json",dataType:"json",success:function(t){var e=t.data,a=e.shop_id,i=e.shop_name,s=e.shop_logo,o=e.shop_banner,r=e.shop_description;n.form={shop_id:a,shop_name:i,shop_logo:s,shop_banner:o,shop_description:r}}})},submitHandle:function(){$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Shop&met=edit&typ=json",dataType:"json",data:this.form,success:function(t){200===t.status?alert("操作成功"):$.sDialog({skin:"red",content:t.msg,okBtn:!1,cancelBtn:!1})}})},backHandle:function(){history.go(-1)}},mounted:function(){var a=this;$('input[name="upfile"]').ajaxUploadImage({url:SYS.URL.upload,data:{},start:function(t){t.parent().after('<div class="upload-loading"><i></i></div>'),t.parent().siblings(".pic-thumb").remove()},success:function(t,e){if(200!=e.status)return t.parent().siblings(".upload-loading").remove(),$.sDialog({skin:"red",content:__("图片尺寸过大！"),okBtn:!1,cancelBtn:!1}),!1;t.parent().after('<div class="pic-thumb"><img src="'+e.data.url+'"/></div>'),t.parent().siblings(".upload-loading").remove(),a.form[t[0].id]=e.data.url}})},created:function(){this.getData()}})}(),function(){if(document.getElementById("product"))new Vue({el:"#product",data:{productLists:{page:1,records:0,total:0,items:[]},productData:{page:1,records:0,total:0,items:[]}},methods:{getData:function(t){var e=this;if(this.productLists.total!=this.productLists.page){var a={page:t||1,rows:10};$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Product&met=lists&typ=json",data:a,dataType:"json",success:function(t){e.productLists.page=t.data.page,e.productLists.records=t.data.records,e.productLists.total=t.data.total,e.productLists.items.push.apply(e.productLists.items,t.data.items)}})}},getProduct:function(t){var e=this;if(this.productData.total!=this.productData.page){var a={page:t||1,rows:1e3};$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Product&met=product&typ=json",data:a,dataType:"json",success:function(t){e.productData.page=t.data.page,e.productData.records=t.data.records,e.productData.total=t.data.total,e.productData.items.push.apply(e.productData.items,t.data.items)}})}},productRouterHandle:function(t){var e=void 0;e=t.item_id?WapSiteUrl+"/tmpl/product_detail.html?item_id="+t.item_id+"&sharer="+t.directseller_id:WapSiteUrl+"/tmpl/product_detail.html?product_id="+t.product_id+"&sharer="+t.directseller_id,window.location.href=e},addHandle:function(t){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Product&met=add&typ=json",data:{product_id:t},dataType:"json",success:function(t){200===t.status?(alert("操作成功"),e.productLists.items.unshift(t.data)):$.sDialog({skin:"red",content:t.msg,okBtn:!1,cancelBtn:!1})}})},removeHandle:function(t,e){var a=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Product&met=remove&typ=json",data:{directseller_product_id:t},dataType:"json",success:function(t){200===t.status?(alert("操作成功"),a.productLists.items.splice(e,1)):$.sDialog({skin:"red",content:t.msg,okBtn:!1,cancelBtn:!1})}})},clickHandle:function(){this.getProduct()},backHandle:function(){history.go(-1)}},mounted:function(){$.animationLeft({valve:"#add",wrapper:"#productAdd",scroll:""})},created:function(){var t=this;this.getData(),$(window).scroll(function(){$(window).scrollTop()+$(window).height()>$(document).height()-1&&t.getData(t.productLists.page+1)})}})}(),function(){if(document.getElementById("shop"))new Vue({el:"#shop",data:{shop_id:0,shopData:{},productLists:{page:1,records:0,total:0,items:[]}},methods:{getData:function(){var e=this;$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Shop&met=get&typ=json",data:{shop_id:this.shop_id},dataType:"json",success:function(t){e.shopData=t.data}})},getProductData:function(t){var e=this;if(this.productLists.total!=this.productLists.page){var a={page:t||1,rows:10};$.request({type:"get",url:ApiUrl+"/index.php?ctl=Distribution_Product&met=lists&typ=json",data:a,dataType:"json",success:function(t){e.productLists.page=t.data.page,e.productLists.records=t.data.records,e.productLists.total=t.data.total,e.productLists.items.push.apply(e.productLists.items,t.data.items)}})}},productRouterHandle:function(t){var e=void 0;e=t.item_id?WapSiteUrl+"/tmpl/product_detail.html?item_id="+t.item_id+"&sharer="+t.directseller_id:WapSiteUrl+"/tmpl/product_detail.html?product_id="+t.product_id+"&sharer="+t.directseller_id,window.location.href=e},backHandle:function(){history.go(-1)}},created:function(){this.shop_id=getQueryString("shop_id"),this.getData(),this.getProductData()}})}();